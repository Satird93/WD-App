-- ==============================================
-- МИГРАЦИЯ: RLS ПОЛИТИКА ДЛЯ УДАЛЕНИЯ АККАУНТА
-- ==============================================
-- Дата: 2026-02-14
-- Описание: Добавляет RLS политику для разрешения пользователям
-- удалять собственные аккаунты

-- Включаем RLS для таблицы users (если ещё не включено)
ALTER TABLE users ENABLE ROW LEVEL SECURITY;

-- Политика для удаления собственного аккаунта
-- Примечание: В текущей реализации нет Supabase Auth,
-- поэтому политика разрешает удаление всем (контроль на уровне приложения)
CREATE POLICY "Users can delete own account" ON users
  FOR DELETE USING (true);

-- Комментарий
COMMENT ON POLICY "Users can delete own account" ON users IS 
'Разрешает пользователям удалять собственные аккаунты. Контроль доступа осуществляется на уровне приложения через telegram_id.';
